---
layout:       post
title:        "由 Https 握手引发的一系列..."
subtitle:     ""
date:         2018-04-03 00:00:00
author:       "Guang1234567"
header-img:   "img/home-bg-o.jpg"
header-mask:  0.3
catalog:      true
multilingual: false
music-enable: true
categories:
    - Https
    - http
    - osi
    - TCP_IP
tags:
    - Https
    - http
    - osi
    - TCP_IP
---


> 请勿转载...

> 目的: 了解 Https 握手的过程...

**目录:**

* content
{:toc}

## 背景知识

### OSI 和 TCP/IP

- **OSI** 是 **Open System Interconnection**的缩写，意为**开放式系统互联**。国际标准化组织（ISO）制定了OSI模型，该模型定义了不同计算机互联的标准，是设计和描述计算机网络通信的基本框架。OSI模型把网络通信的工作分为7层，分别是物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。

![]({{ "/img/in-post/2018-04-03-handshake-of-https/705728-20160424234824085-667046040.png" | prepend: site.baseurl }})

        各层功能定义
                这里我们只对OSI各层进行功能上的大概阐述，不详细深究，因为每一层实际都是一个复杂的层。后面我也会根据个人方向展开部分层的深入学习。这里我们就大概了解一下。我们从最顶层——应用层 开始介绍。整个过程以公司A和公司B的一次商业报价单发送为例子进行讲解。
        <1>    应用层
                OSI参考模型中最靠近用户的一层，是为计算机用户提供应用接口，也为用户直接提供各种网络服务。我们常见应用层的网络服务协议有：HTTP，HTTPS，FTP，POP3、SMTP等。
                实际公司A的老板就是我们所述的用户，而他要发送的商业报价单，就是应用层提供的一种网络服务，当然，老板也可以选择其他服务，比如说，发一份商业合同，发一份询价单，等等。
        <2>    表示层
                表示层提供各种用于应用层数据的编码和转换功能,确保一个系统的应用层发送的数据能被另一个系统的应用层识别。如果必要，该层可提供一种标准表示形式，用于将计算机内部的多种数据格式转换成通信中采用的标准表示形式。数据压缩和加密也是表示层可提供的转换功能之一。
                由于公司A和公司B是不同国家的公司，他们之间的商定统一用英语作为交流的语言，所以此时表示层（公司的文秘），就是将应用层的传递信息转翻译成英语。同时为了防止别的公司看到，公司A的人也会对这份报价单做一些加密的处理。这就是表示的作用，将应用层的数据转换翻译等。
        <3>    会话层
                会话层就是负责建立、管理和终止表示层实体之间的通信会话。该层的通信由不同设备中的应用程序之间的服务请求和响应组成。      
                会话层的同事拿到表示层的同事转换后资料，（会话层的同事类似公司的外联部），会话层的同事那里可能会掌握本公司与其他好多公司的联系方式，这里公司就是实际传递过程中的实体。他们要管理本公司与外界好多公司的联系会话。当接收到表示层的数据后，会话层将会建立并记录本次会话，他首先要找到公司B的地址信息，然后将整份资料放进信封，并写上地址和联系方式。准备将资料寄出。等到确定公司B接收到此份报价单后，此次会话就算结束了，外联部的同事就会终止此次会话。
        <4>   传输层
                传输层建立了主机端到端的链接，传输层的作用是为上层协议提供端到端的可靠和透明的数据传输服务，包括处理差错控制和流量控制等问题。该层向高层屏蔽了下层数据通信的细节，使高层用户看到的只是在两个传输实体间的一条主机到主机的、可由用户控制和设定的、可靠的数据通路。我们通常说的，TCP UDP就是在这一层。端口号既是这里的“端”。
                传输层就相当于公司中的负责快递邮件收发的人，公司自己的投递员，他们负责将上一层的要寄出的资料投递到快递公司或邮局。
        <5>   网络层
               本层通过IP寻址来建立两个节点之间的连接，为源端的运输层送来的分组，选择合适的路由和交换节点，正确无误地按照地址传送给目的端的运输层。就是通常说的IP层。这一层就是我们经常说的IP协议层。IP协议是Internet的基础。
                网络层就相当于快递公司庞大的快递网络，全国不同的集散中心，比如说，从深圳发往北京的顺丰快递（陆运为例啊，空运好像直接就飞到北京了），首先要到顺丰的深圳集散中心，从深圳集散中心再送到武汉集散中心，从武汉集散中心再寄到北京顺义集散中心。这个每个集散中心，就相当于网络中的一个IP节点。
        <6>   数据链路层 
                将比特组合成字节,再将字节组合成帧,使用链路层地址 (以太网使用MAC地址)来访问介质,并进行差错检测。
             数据链路层又分为2个子层：逻辑链路控制子层（LLC）和媒体访问控制子层（MAC）。

                MAC子层处理CSMA/CD算法、数据出错校验、成帧等；LLC子层定义了一些字段使上次协议能共享数据链路层。 在实际使用中，LLC子层并非必需的。

                这个没找到合适的例子

        <7>  物理层     
                实际最终信号的传输是通过物理层实现的。通过物理介质传输比特流。规定了电平、速度和电缆针脚。常用设备有（各种物理设备）集线器、中继器、调制解调器、网线、双绞线、同轴电缆。这些都是物理层的传输介质。
                 快递寄送过程中的交通工具，就相当于我们的物理层，例如汽车，火车，飞机，船。

- **TCP/IP** 是 **Transmission Control Protocol/Internet Protocol** 的简写，中译名为**传输控制协议/因特网互联协议**，又名**网络通讯协议**，是Internet最基本的协议、Internet国际互联网络的基础，由网络层的IP协议和传输层的TCP协议组成。TCP/IP 定义了电子设备如何连入因特网，以及数据如何在它们之间传输的标准。协议采用了4层的层级结构，每一层都呼叫它的下一层所提供的协议来完成自己的需求。通俗而言：TCP负责发现传输的问题，一有问题就发出信号，要求重新传输，直到所有数据安全正确地传输到目的地。而IP是给因特网的每一台联网设备规定一个地址。

![]({{ "/img/in-post/2018-04-03-handshake-of-https/705728-20160424234825491-384470376.png" | prepend: site.baseurl }})

### **OSI** VS **TCP/IP**

**TCP/IP**模型实际上是 **OSI** 模型的一个浓缩版本，它只有四个层次：

1. 应用层，对应着OSI的应用层、表示层、会话层
2. 传输层，对应着OSI的传输层
3. 网络层，对应着OSI的网络层
4. 网络接口层，对应着OSI的数据链路层和物理层

OSI模型的网络层同时支持面向连接和无连接的通信，但是传输层只支持面向连接的通信；

TCP/IP模型的网络层只提供无连接的服务，但是传输层上同时提供两种通信模式。


### 协议层的一些实现举例

每层协议都有一些具体实现, 直接看下面的表格和图片.

OSI中的层 | 功能                                                                   | TCP/IP协议族                            
------ | -------------------------------------------------------------------- | -------------------------------------
应用层    | 文件传输，电子邮件，文件服务，虚拟终端                                                  | TFTP，HTTP，SNMP，FTP，SMTP，DNS，Telnet 等等
表示层    | 数据格式化，代码转换，数据加密                                                      | 没有协议                                 
会话层    | 解除或建立与别的接点的联系                                                        | 没有协议                                 
传输层    | 提供[端对端](https://baike.baidu.com/item/%E7%AB%AF%E5%AF%B9%E7%AB%AF)的接口 | TCP，UDP                              
网络层    | 为[数据包](https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%8C%85)选择路由 | IP，ICMP，OSPF，EIGRP，IGMP              
数据链路层  | 传输有地址的帧以及错误检测功能                                                      | SLIP，CSLIP，PPP，MTU                   
物理层    | 以二进制数据形式在物理媒体上传输数据                                                   | ISO2110，IEEE802，IEEE802.2            


![]({{ "/img/in-post/2018-04-03-handshake-of-https/705728-20160424234827195-1493107425.png" | prepend: site.baseurl }})

![]({{ "/img/in-post/2018-04-03-handshake-of-https/555379-20160210231238370-230545857.png" | prepend: site.baseurl }})

### 支撑起协议层的一些硬件设备

在每一层都工作着不同的设备，比如我们常用的交换机就工作在数据链路层的，一般的路由器是工作在网络层的。

![]({{ "/img/in-post/2018-04-03-handshake-of-https/705728-20160424234826351-1957282396.png" | prepend: site.baseurl }})


### Http 协议

**HTTP**是一种 **应用层协议**(看上面的表格).

用来干什么? 看 **OSI** 截图(最顶的三层)


### TCP 协议

**TCP** 是一种 **传输层协议**, 支持面向连接的通信协议

### UDP 协议

**UDP** 是一种 **传输层协议**, 支持面向无连接的通信协议

### SSL/TLS 协议

**UDP** 是一种 **传输层协议**.

SSL(Secure Sockets Layer 安全套接层),及其继任者传输层安全（Transport Layer Security，TLS）是为网络通信提供安全及数据完整性的一种安全协议。TLS与SSL在传输层对网络连接进行加密。

### IP 协议

**IP** 是一种 **网络层协议**

### 常挂在嘴边的 Http 协议是? 

    网络层(用IP协议) + 传输层(用TCP协议) + 应用层(用 Http 协议) 的一种组合结构...(真相总是残酷的 ε(┬┬﹏┬┬)3 )
    
    
### 常挂在嘴边的 Https 协议是? 

    网络层(用IP协议) + 传输层(用SSL/TLS协议) + 应用层(用 Http 协议) 的一种组合结构...(真相总是残酷的 ε(┬┬﹏┬┬)3 )





